(begin
  (define (array:opt-make) (list 'type2 "array:" 4))
  (define (array:optimize f r empty?)
    (if empty?
      (lambda ks -1)
      (case r
        ((0) (let ((n0 (f))) (array:0 n0)))
        ((1) (let ((n0 (f 0))) (array:1 n0 (- (f 1) n0))))
        ((2) (let ((n0 (f 0 0))) (array:2 n0 (- (f 1 0) n0) (- (f 0 1) n0))))
        ((3)
         (let ((n0 (f 0 0 0)))
           (array:3 n0 (- (f 1 0 0) n0) (- (f 0 1 0) n0) (- (f 0 0 1) n0))))
        (else
         (let ((v (do ((k 0 (+ k 1)) (v '() (cons 0 v))) ((= k r) v))))
           (let ((n0 (apply f v)))
             (array:n n0 (array:coefficients f n0 v v))))))))
  (define (array:coefficients f n0 vs vp)
    (case vp
      ((()) '())
      (else
       (set-car! vp 1)
       (let ((n (- (apply f vs) n0)))
         (set-car! vp 0)
         (cons n (array:coefficients f n0 vs (cdr vp)))))))
  (begin
    (define (array:0 n0) (if (= n0 0) (array:0.0) (array:0.n n0)))
    (define (array:0.0) (lambda () 0))
    (define (array:0.n n0) (lambda () n0)))
  (begin
    (define (array:1 n0 n1)
      (if (= n0 0)
        (case n1
          ((-1) (array:1.0.-1))
          ((0) (array:1.0.0))
          ((1) (array:1.0.1))
          (else (array:1.0.n n1)))
        (case n1
          ((-1) (array:1.n.-1 n0))
          ((0) (array:1.n.0 n0))
          ((1) (array:1.n.1 n0))
          (else (array:1.n.n n0 n1)))))
    (define (array:1.0.-1) (lambda (k1) (- k1)))
    (define (array:1.0.0) (lambda (k1) 0))
    (define (array:1.0.1) (lambda (k1) k1))
    (define (array:1.0.n n1) (lambda (k1) (* n1 k1)))
    (define (array:1.n.-1 n0) (lambda (k1) (+ n0 (- k1))))
    (define (array:1.n.0 n0) (lambda (k1) n0))
    (define (array:1.n.1 n0) (lambda (k1) (+ n0 k1)))
    (define (array:1.n.n n0 n1) (lambda (k1) (+ n0 (* n1 k1)))))
  (begin
    (define (array:2 n0 n1 n2)
      (if (= n0 0)
        (case n1
          ((-1)
           (case n2
             ((-1) (array:2.0.-1.-1))
             ((0) (array:2.0.-1.0))
             ((1) (array:2.0.-1.1))
             (else (array:2.0.-1.n n2))))
          ((0)
           (case n2
             ((-1) (array:2.0.0.-1))
             ((0) (array:2.0.0.0))
             ((1) (array:2.0.0.1))
             (else (array:2.0.0.n n2))))
          ((1)
           (case n2
             ((-1) (array:2.0.1.-1))
             ((0) (array:2.0.1.0))
             ((1) (array:2.0.1.1))
             (else (array:2.0.1.n n2))))
          (else
           (case n2
             ((-1) (array:2.0.n.-1 n1))
             ((0) (array:2.0.n.0 n1))
             ((1) (array:2.0.n.1 n1))
             (else (array:2.0.n.n n1 n2)))))
        (case n1
          ((-1)
           (case n2
             ((-1) (array:2.n.-1.-1 n0))
             ((0) (array:2.n.-1.0 n0))
             ((1) (array:2.n.-1.1 n0))
             (else (array:2.n.-1.n n0 n2))))
          ((0)
           (case n2
             ((-1) (array:2.n.0.-1 n0))
             ((0) (array:2.n.0.0 n0))
             ((1) (array:2.n.0.1 n0))
             (else (array:2.n.0.n n0 n2))))
          ((1)
           (case n2
             ((-1) (array:2.n.1.-1 n0))
             ((0) (array:2.n.1.0 n0))
             ((1) (array:2.n.1.1 n0))
             (else (array:2.n.1.n n0 n2))))
          (else
           (case n2
             ((-1) (array:2.n.n.-1 n0 n1))
             ((0) (array:2.n.n.0 n0 n1))
             ((1) (array:2.n.n.1 n0 n1))
             (else (array:2.n.n.n n0 n1 n2)))))))
    (define (array:2.0.-1.-1) (lambda (k1 k2) (+ (- k1) (- k2))))
    (define (array:2.0.-1.0) (lambda (k1 k2) (- k1)))
    (define (array:2.0.-1.1) (lambda (k1 k2) (+ (- k1) k2)))
    (define (array:2.0.-1.n n2) (lambda (k1 k2) (+ (- k1) (* n2 k2))))
    (define (array:2.0.0.-1) (lambda (k1 k2) (- k2)))
    (define (array:2.0.0.0) (lambda (k1 k2) 0))
    (define (array:2.0.0.1) (lambda (k1 k2) k2))
    (define (array:2.0.0.n n2) (lambda (k1 k2) (* n2 k2)))
    (define (array:2.0.1.-1) (lambda (k1 k2) (+ k1 (- k2))))
    (define (array:2.0.1.0) (lambda (k1 k2) k1))
    (define (array:2.0.1.1) (lambda (k1 k2) (+ k1 k2)))
    (define (array:2.0.1.n n2) (lambda (k1 k2) (+ k1 (* n2 k2))))
    (define (array:2.0.n.-1 n1) (lambda (k1 k2) (+ (* n1 k1) (- k2))))
    (define (array:2.0.n.0 n1) (lambda (k1 k2) (* n1 k1)))
    (define (array:2.0.n.1 n1) (lambda (k1 k2) (+ (* n1 k1) k2)))
    (define (array:2.0.n.n n1 n2) (lambda (k1 k2) (+ (* n1 k1) (* n2 k2))))
    (define (array:2.n.-1.-1 n0) (lambda (k1 k2) (+ n0 (- k1) (- k2))))
    (define (array:2.n.-1.0 n0) (lambda (k1 k2) (+ n0 (- k1))))
    (define (array:2.n.-1.1 n0) (lambda (k1 k2) (+ n0 (- k1) k2)))
    (define (array:2.n.-1.n n0 n2) (lambda (k1 k2) (+ n0 (- k1) (* n2 k2))))
    (define (array:2.n.0.-1 n0) (lambda (k1 k2) (+ n0 (- k2))))
    (define (array:2.n.0.0 n0) (lambda (k1 k2) n0))
    (define (array:2.n.0.1 n0) (lambda (k1 k2) (+ n0 k2)))
    (define (array:2.n.0.n n0 n2) (lambda (k1 k2) (+ n0 (* n2 k2))))
    (define (array:2.n.1.-1 n0) (lambda (k1 k2) (+ n0 k1 (- k2))))
    (define (array:2.n.1.0 n0) (lambda (k1 k2) (+ n0 k1)))
    (define (array:2.n.1.1 n0) (lambda (k1 k2) (+ n0 k1 k2)))
    (define (array:2.n.1.n n0 n2) (lambda (k1 k2) (+ n0 k1 (* n2 k2))))
    (define (array:2.n.n.-1 n0 n1) (lambda (k1 k2) (+ n0 (* n1 k1) (- k2))))
    (define (array:2.n.n.0 n0 n1) (lambda (k1 k2) (+ n0 (* n1 k1))))
    (define (array:2.n.n.1 n0 n1) (lambda (k1 k2) (+ n0 (* n1 k1) k2)))
    (define (array:2.n.n.n n0 n1 n2)
      (lambda (k1 k2) (+ n0 (* n1 k1) (* n2 k2)))))
  (begin
    (define (array:3 n0 n1 n2 n3)
      (if (= n0 0)
        (case n1
          ((-1)
           (case n2
             ((-1)
              (case n3
                ((-1) (array:3.0.-1.-1.-1))
                ((0) (array:3.0.-1.-1.0))
                ((1) (array:3.0.-1.-1.1))
                (else (array:3.0.-1.-1.n n3))))
             ((0)
              (case n3
                ((-1) (array:3.0.-1.0.-1))
                ((0) (array:3.0.-1.0.0))
                ((1) (array:3.0.-1.0.1))
                (else (array:3.0.-1.0.n n3))))
             ((1)
              (case n3
                ((-1) (array:3.0.-1.1.-1))
                ((0) (array:3.0.-1.1.0))
                ((1) (array:3.0.-1.1.1))
                (else (array:3.0.-1.1.n n3))))
             (else
              (case n3
                ((-1) (array:3.0.-1.n.-1 n2))
                ((0) (array:3.0.-1.n.0 n2))
                ((1) (array:3.0.-1.n.1 n2))
                (else (array:3.0.-1.n.n n2 n3))))))
          ((0)
           (case n2
             ((-1)
              (case n3
                ((-1) (array:3.0.0.-1.-1))
                ((0) (array:3.0.0.-1.0))
                ((1) (array:3.0.0.-1.1))
                (else (array:3.0.0.-1.n n3))))
             ((0)
              (case n3
                ((-1) (array:3.0.0.0.-1))
                ((0) (array:3.0.0.0.0))
                ((1) (array:3.0.0.0.1))
                (else (array:3.0.0.0.n n3))))
             ((1)
              (case n3
                ((-1) (array:3.0.0.1.-1))
                ((0) (array:3.0.0.1.0))
                ((1) (array:3.0.0.1.1))
                (else (array:3.0.0.1.n n3))))
             (else
              (case n3
                ((-1) (array:3.0.0.n.-1 n2))
                ((0) (array:3.0.0.n.0 n2))
                ((1) (array:3.0.0.n.1 n2))
                (else (array:3.0.0.n.n n2 n3))))))
          ((1)
           (case n2
             ((-1)
              (case n3
                ((-1) (array:3.0.1.-1.-1))
                ((0) (array:3.0.1.-1.0))
                ((1) (array:3.0.1.-1.1))
                (else (array:3.0.1.-1.n n3))))
             ((0)
              (case n3
                ((-1) (array:3.0.1.0.-1))
                ((0) (array:3.0.1.0.0))
                ((1) (array:3.0.1.0.1))
                (else (array:3.0.1.0.n n3))))
             ((1)
              (case n3
                ((-1) (array:3.0.1.1.-1))
                ((0) (array:3.0.1.1.0))
                ((1) (array:3.0.1.1.1))
                (else (array:3.0.1.1.n n3))))
             (else
              (case n3
                ((-1) (array:3.0.1.n.-1 n2))
                ((0) (array:3.0.1.n.0 n2))
                ((1) (array:3.0.1.n.1 n2))
                (else (array:3.0.1.n.n n2 n3))))))
          (else
           (case n2
             ((-1)
              (case n3
                ((-1) (array:3.0.n.-1.-1 n1))
                ((0) (array:3.0.n.-1.0 n1))
                ((1) (array:3.0.n.-1.1 n1))
                (else (array:3.0.n.-1.n n1 n3))))
             ((0)
              (case n3
                ((-1) (array:3.0.n.0.-1 n1))
                ((0) (array:3.0.n.0.0 n1))
                ((1) (array:3.0.n.0.1 n1))
                (else (array:3.0.n.0.n n1 n3))))
             ((1)
              (case n3
                ((-1) (array:3.0.n.1.-1 n1))
                ((0) (array:3.0.n.1.0 n1))
                ((1) (array:3.0.n.1.1 n1))
                (else (array:3.0.n.1.n n1 n3))))
             (else
              (case n3
                ((-1) (array:3.0.n.n.-1 n1 n2))
                ((0) (array:3.0.n.n.0 n1 n2))
                ((1) (array:3.0.n.n.1 n1 n2))
                (else (array:3.0.n.n.n n1 n2 n3)))))))
        (case n1
          ((-1)
           (case n2
             ((-1)
              (case n3
                ((-1) (array:3.n.-1.-1.-1 n0))
                ((0) (array:3.n.-1.-1.0 n0))
                ((1) (array:3.n.-1.-1.1 n0))
                (else (array:3.n.-1.-1.n n0 n3))))
             ((0)
              (case n3
                ((-1) (array:3.n.-1.0.-1 n0))
                ((0) (array:3.n.-1.0.0 n0))
                ((1) (array:3.n.-1.0.1 n0))
                (else (array:3.n.-1.0.n n0 n3))))
             ((1)
              (case n3
                ((-1) (array:3.n.-1.1.-1 n0))
                ((0) (array:3.n.-1.1.0 n0))
                ((1) (array:3.n.-1.1.1 n0))
                (else (array:3.n.-1.1.n n0 n3))))
             (else
              (case n3
                ((-1) (array:3.n.-1.n.-1 n0 n2))
                ((0) (array:3.n.-1.n.0 n0 n2))
                ((1) (array:3.n.-1.n.1 n0 n2))
                (else (array:3.n.-1.n.n n0 n2 n3))))))
          ((0)
           (case n2
             ((-1)
              (case n3
                ((-1) (array:3.n.0.-1.-1 n0))
                ((0) (array:3.n.0.-1.0 n0))
                ((1) (array:3.n.0.-1.1 n0))
                (else (array:3.n.0.-1.n n0 n3))))
             ((0)
              (case n3
                ((-1) (array:3.n.0.0.-1 n0))
                ((0) (array:3.n.0.0.0 n0))
                ((1) (array:3.n.0.0.1 n0))
                (else (array:3.n.0.0.n n0 n3))))
             ((1)
              (case n3
                ((-1) (array:3.n.0.1.-1 n0))
                ((0) (array:3.n.0.1.0 n0))
                ((1) (array:3.n.0.1.1 n0))
                (else (array:3.n.0.1.n n0 n3))))
             (else
              (case n3
                ((-1) (array:3.n.0.n.-1 n0 n2))
                ((0) (array:3.n.0.n.0 n0 n2))
                ((1) (array:3.n.0.n.1 n0 n2))
                (else (array:3.n.0.n.n n0 n2 n3))))))
          ((1)
           (case n2
             ((-1)
              (case n3
                ((-1) (array:3.n.1.-1.-1 n0))
                ((0) (array:3.n.1.-1.0 n0))
                ((1) (array:3.n.1.-1.1 n0))
                (else (array:3.n.1.-1.n n0 n3))))
             ((0)
              (case n3
                ((-1) (array:3.n.1.0.-1 n0))
                ((0) (array:3.n.1.0.0 n0))
                ((1) (array:3.n.1.0.1 n0))
                (else (array:3.n.1.0.n n0 n3))))
             ((1)
              (case n3
                ((-1) (array:3.n.1.1.-1 n0))
                ((0) (array:3.n.1.1.0 n0))
                ((1) (array:3.n.1.1.1 n0))
                (else (array:3.n.1.1.n n0 n3))))
             (else
              (case n3
                ((-1) (array:3.n.1.n.-1 n0 n2))
                ((0) (array:3.n.1.n.0 n0 n2))
                ((1) (array:3.n.1.n.1 n0 n2))
                (else (array:3.n.1.n.n n0 n2 n3))))))
          (else
           (case n2
             ((-1)
              (case n3
                ((-1) (array:3.n.n.-1.-1 n0 n1))
                ((0) (array:3.n.n.-1.0 n0 n1))
                ((1) (array:3.n.n.-1.1 n0 n1))
                (else (array:3.n.n.-1.n n0 n1 n3))))
             ((0)
              (case n3
                ((-1) (array:3.n.n.0.-1 n0 n1))
                ((0) (array:3.n.n.0.0 n0 n1))
                ((1) (array:3.n.n.0.1 n0 n1))
                (else (array:3.n.n.0.n n0 n1 n3))))
             ((1)
              (case n3
                ((-1) (array:3.n.n.1.-1 n0 n1))
                ((0) (array:3.n.n.1.0 n0 n1))
                ((1) (array:3.n.n.1.1 n0 n1))
                (else (array:3.n.n.1.n n0 n1 n3))))
             (else
              (case n3
                ((-1) (array:3.n.n.n.-1 n0 n1 n2))
                ((0) (array:3.n.n.n.0 n0 n1 n2))
                ((1) (array:3.n.n.n.1 n0 n1 n2))
                (else (array:3.n.n.n.n n0 n1 n2 n3)))))))))
    (define (array:3.0.-1.-1.-1) (lambda (k1 k2 k3) (+ (- k1) (- k2) (- k3))))
    (define (array:3.0.-1.-1.0) (lambda (k1 k2 k3) (+ (- k1) (- k2))))
    (define (array:3.0.-1.-1.1) (lambda (k1 k2 k3) (+ (- k1) (- k2) k3)))
    (define (array:3.0.-1.-1.n n3)
      (lambda (k1 k2 k3) (+ (- k1) (- k2) (* n3 k3))))
    (define (array:3.0.-1.0.-1) (lambda (k1 k2 k3) (+ (- k1) (- k3))))
    (define (array:3.0.-1.0.0) (lambda (k1 k2 k3) (- k1)))
    (define (array:3.0.-1.0.1) (lambda (k1 k2 k3) (+ (- k1) k3)))
    (define (array:3.0.-1.0.n n3) (lambda (k1 k2 k3) (+ (- k1) (* n3 k3))))
    (define (array:3.0.-1.1.-1) (lambda (k1 k2 k3) (+ (- k1) k2 (- k3))))
    (define (array:3.0.-1.1.0) (lambda (k1 k2 k3) (+ (- k1) k2)))
    (define (array:3.0.-1.1.1) (lambda (k1 k2 k3) (+ (- k1) k2 k3)))
    (define (array:3.0.-1.1.n n3) (lambda (k1 k2 k3) (+ (- k1) k2 (* n3 k3))))
    (define (array:3.0.-1.n.-1 n2)
      (lambda (k1 k2 k3) (+ (- k1) (* n2 k2) (- k3))))
    (define (array:3.0.-1.n.0 n2) (lambda (k1 k2 k3) (+ (- k1) (* n2 k2))))
    (define (array:3.0.-1.n.1 n2) (lambda (k1 k2 k3) (+ (- k1) (* n2 k2) k3)))
    (define (array:3.0.-1.n.n n2 n3)
      (lambda (k1 k2 k3) (+ (- k1) (* n2 k2) (* n3 k3))))
    (define (array:3.0.0.-1.-1) (lambda (k1 k2 k3) (+ (- k2) (- k3))))
    (define (array:3.0.0.-1.0) (lambda (k1 k2 k3) (- k2)))
    (define (array:3.0.0.-1.1) (lambda (k1 k2 k3) (+ (- k2) k3)))
    (define (array:3.0.0.-1.n n3) (lambda (k1 k2 k3) (+ (- k2) (* n3 k3))))
    (define (array:3.0.0.0.-1) (lambda (k1 k2 k3) (- k3)))
    (define (array:3.0.0.0.0) (lambda (k1 k2 k3) 0))
    (define (array:3.0.0.0.1) (lambda (k1 k2 k3) k3))
    (define (array:3.0.0.0.n n3) (lambda (k1 k2 k3) (* n3 k3)))
    (define (array:3.0.0.1.-1) (lambda (k1 k2 k3) (+ k2 (- k3))))
    (define (array:3.0.0.1.0) (lambda (k1 k2 k3) k2))
    (define (array:3.0.0.1.1) (lambda (k1 k2 k3) (+ k2 k3)))
    (define (array:3.0.0.1.n n3) (lambda (k1 k2 k3) (+ k2 (* n3 k3))))
    (define (array:3.0.0.n.-1 n2) (lambda (k1 k2 k3) (+ (* n2 k2) (- k3))))
    (define (array:3.0.0.n.0 n2) (lambda (k1 k2 k3) (* n2 k2)))
    (define (array:3.0.0.n.1 n2) (lambda (k1 k2 k3) (+ (* n2 k2) k3)))
    (define (array:3.0.0.n.n n2 n3)
      (lambda (k1 k2 k3) (+ (* n2 k2) (* n3 k3))))
    (define (array:3.0.1.-1.-1) (lambda (k1 k2 k3) (+ k1 (- k2) (- k3))))
    (define (array:3.0.1.-1.0) (lambda (k1 k2 k3) (+ k1 (- k2))))
    (define (array:3.0.1.-1.1) (lambda (k1 k2 k3) (+ k1 (- k2) k3)))
    (define (array:3.0.1.-1.n n3) (lambda (k1 k2 k3) (+ k1 (- k2) (* n3 k3))))
    (define (array:3.0.1.0.-1) (lambda (k1 k2 k3) (+ k1 (- k3))))
    (define (array:3.0.1.0.0) (lambda (k1 k2 k3) k1))
    (define (array:3.0.1.0.1) (lambda (k1 k2 k3) (+ k1 k3)))
    (define (array:3.0.1.0.n n3) (lambda (k1 k2 k3) (+ k1 (* n3 k3))))
    (define (array:3.0.1.1.-1) (lambda (k1 k2 k3) (+ k1 k2 (- k3))))
    (define (array:3.0.1.1.0) (lambda (k1 k2 k3) (+ k1 k2)))
    (define (array:3.0.1.1.1) (lambda (k1 k2 k3) (+ k1 k2 k3)))
    (define (array:3.0.1.1.n n3) (lambda (k1 k2 k3) (+ k1 k2 (* n3 k3))))
    (define (array:3.0.1.n.-1 n2) (lambda (k1 k2 k3) (+ k1 (* n2 k2) (- k3))))
    (define (array:3.0.1.n.0 n2) (lambda (k1 k2 k3) (+ k1 (* n2 k2))))
    (define (array:3.0.1.n.1 n2) (lambda (k1 k2 k3) (+ k1 (* n2 k2) k3)))
    (define (array:3.0.1.n.n n2 n3)
      (lambda (k1 k2 k3) (+ k1 (* n2 k2) (* n3 k3))))
    (define (array:3.0.n.-1.-1 n1)
      (lambda (k1 k2 k3) (+ (* n1 k1) (- k2) (- k3))))
    (define (array:3.0.n.-1.0 n1) (lambda (k1 k2 k3) (+ (* n1 k1) (- k2))))
    (define (array:3.0.n.-1.1 n1) (lambda (k1 k2 k3) (+ (* n1 k1) (- k2) k3)))
    (define (array:3.0.n.-1.n n1 n3)
      (lambda (k1 k2 k3) (+ (* n1 k1) (- k2) (* n3 k3))))
    (define (array:3.0.n.0.-1 n1) (lambda (k1 k2 k3) (+ (* n1 k1) (- k3))))
    (define (array:3.0.n.0.0 n1) (lambda (k1 k2 k3) (* n1 k1)))
    (define (array:3.0.n.0.1 n1) (lambda (k1 k2 k3) (+ (* n1 k1) k3)))
    (define (array:3.0.n.0.n n1 n3)
      (lambda (k1 k2 k3) (+ (* n1 k1) (* n3 k3))))
    (define (array:3.0.n.1.-1 n1) (lambda (k1 k2 k3) (+ (* n1 k1) k2 (- k3))))
    (define (array:3.0.n.1.0 n1) (lambda (k1 k2 k3) (+ (* n1 k1) k2)))
    (define (array:3.0.n.1.1 n1) (lambda (k1 k2 k3) (+ (* n1 k1) k2 k3)))
    (define (array:3.0.n.1.n n1 n3)
      (lambda (k1 k2 k3) (+ (* n1 k1) k2 (* n3 k3))))
    (define (array:3.0.n.n.-1 n1 n2)
      (lambda (k1 k2 k3) (+ (* n1 k1) (* n2 k2) (- k3))))
    (define (array:3.0.n.n.0 n1 n2)
      (lambda (k1 k2 k3) (+ (* n1 k1) (* n2 k2))))
    (define (array:3.0.n.n.1 n1 n2)
      (lambda (k1 k2 k3) (+ (* n1 k1) (* n2 k2) k3)))
    (define (array:3.0.n.n.n n1 n2 n3)
      (lambda (k1 k2 k3) (+ (* n1 k1) (* n2 k2) (* n3 k3))))
    (define (array:3.n.-1.-1.-1 n0)
      (lambda (k1 k2 k3) (+ n0 (- k1) (- k2) (- k3))))
    (define (array:3.n.-1.-1.0 n0) (lambda (k1 k2 k3) (+ n0 (- k1) (- k2))))
    (define (array:3.n.-1.-1.1 n0) (lambda (k1 k2 k3) (+ n0 (- k1) (- k2) k3)))
    (define (array:3.n.-1.-1.n n0 n3)
      (lambda (k1 k2 k3) (+ n0 (- k1) (- k2) (* n3 k3))))
    (define (array:3.n.-1.0.-1 n0) (lambda (k1 k2 k3) (+ n0 (- k1) (- k3))))
    (define (array:3.n.-1.0.0 n0) (lambda (k1 k2 k3) (+ n0 (- k1))))
    (define (array:3.n.-1.0.1 n0) (lambda (k1 k2 k3) (+ n0 (- k1) k3)))
    (define (array:3.n.-1.0.n n0 n3)
      (lambda (k1 k2 k3) (+ n0 (- k1) (* n3 k3))))
    (define (array:3.n.-1.1.-1 n0) (lambda (k1 k2 k3) (+ n0 (- k1) k2 (- k3))))
    (define (array:3.n.-1.1.0 n0) (lambda (k1 k2 k3) (+ n0 (- k1) k2)))
    (define (array:3.n.-1.1.1 n0) (lambda (k1 k2 k3) (+ n0 (- k1) k2 k3)))
    (define (array:3.n.-1.1.n n0 n3)
      (lambda (k1 k2 k3) (+ n0 (- k1) k2 (* n3 k3))))
    (define (array:3.n.-1.n.-1 n0 n2)
      (lambda (k1 k2 k3) (+ n0 (- k1) (* n2 k2) (- k3))))
    (define (array:3.n.-1.n.0 n0 n2)
      (lambda (k1 k2 k3) (+ n0 (- k1) (* n2 k2))))
    (define (array:3.n.-1.n.1 n0 n2)
      (lambda (k1 k2 k3) (+ n0 (- k1) (* n2 k2) k3)))
    (define (array:3.n.-1.n.n n0 n2 n3)
      (lambda (k1 k2 k3) (+ n0 (- k1) (* n2 k2) (* n3 k3))))
    (define (array:3.n.0.-1.-1 n0) (lambda (k1 k2 k3) (+ n0 (- k2) (- k3))))
    (define (array:3.n.0.-1.0 n0) (lambda (k1 k2 k3) (+ n0 (- k2))))
    (define (array:3.n.0.-1.1 n0) (lambda (k1 k2 k3) (+ n0 (- k2) k3)))
    (define (array:3.n.0.-1.n n0 n3)
      (lambda (k1 k2 k3) (+ n0 (- k2) (* n3 k3))))
    (define (array:3.n.0.0.-1 n0) (lambda (k1 k2 k3) (+ n0 (- k3))))
    (define (array:3.n.0.0.0 n0) (lambda (k1 k2 k3) n0))
    (define (array:3.n.0.0.1 n0) (lambda (k1 k2 k3) (+ n0 k3)))
    (define (array:3.n.0.0.n n0 n3) (lambda (k1 k2 k3) (+ n0 (* n3 k3))))
    (define (array:3.n.0.1.-1 n0) (lambda (k1 k2 k3) (+ n0 k2 (- k3))))
    (define (array:3.n.0.1.0 n0) (lambda (k1 k2 k3) (+ n0 k2)))
    (define (array:3.n.0.1.1 n0) (lambda (k1 k2 k3) (+ n0 k2 k3)))
    (define (array:3.n.0.1.n n0 n3) (lambda (k1 k2 k3) (+ n0 k2 (* n3 k3))))
    (define (array:3.n.0.n.-1 n0 n2)
      (lambda (k1 k2 k3) (+ n0 (* n2 k2) (- k3))))
    (define (array:3.n.0.n.0 n0 n2) (lambda (k1 k2 k3) (+ n0 (* n2 k2))))
    (define (array:3.n.0.n.1 n0 n2) (lambda (k1 k2 k3) (+ n0 (* n2 k2) k3)))
    (define (array:3.n.0.n.n n0 n2 n3)
      (lambda (k1 k2 k3) (+ n0 (* n2 k2) (* n3 k3))))
    (define (array:3.n.1.-1.-1 n0) (lambda (k1 k2 k3) (+ n0 k1 (- k2) (- k3))))
    (define (array:3.n.1.-1.0 n0) (lambda (k1 k2 k3) (+ n0 k1 (- k2))))
    (define (array:3.n.1.-1.1 n0) (lambda (k1 k2 k3) (+ n0 k1 (- k2) k3)))
    (define (array:3.n.1.-1.n n0 n3)
      (lambda (k1 k2 k3) (+ n0 k1 (- k2) (* n3 k3))))
    (define (array:3.n.1.0.-1 n0) (lambda (k1 k2 k3) (+ n0 k1 (- k3))))
    (define (array:3.n.1.0.0 n0) (lambda (k1 k2 k3) (+ n0 k1)))
    (define (array:3.n.1.0.1 n0) (lambda (k1 k2 k3) (+ n0 k1 k3)))
    (define (array:3.n.1.0.n n0 n3) (lambda (k1 k2 k3) (+ n0 k1 (* n3 k3))))
    (define (array:3.n.1.1.-1 n0) (lambda (k1 k2 k3) (+ n0 k1 k2 (- k3))))
    (define (array:3.n.1.1.0 n0) (lambda (k1 k2 k3) (+ n0 k1 k2)))
    (define (array:3.n.1.1.1 n0) (lambda (k1 k2 k3) (+ n0 k1 k2 k3)))
    (define (array:3.n.1.1.n n0 n3) (lambda (k1 k2 k3) (+ n0 k1 k2 (* n3 k3))))
    (define (array:3.n.1.n.-1 n0 n2)
      (lambda (k1 k2 k3) (+ n0 k1 (* n2 k2) (- k3))))
    (define (array:3.n.1.n.0 n0 n2) (lambda (k1 k2 k3) (+ n0 k1 (* n2 k2))))
    (define (array:3.n.1.n.1 n0 n2) (lambda (k1 k2 k3) (+ n0 k1 (* n2 k2) k3)))
    (define (array:3.n.1.n.n n0 n2 n3)
      (lambda (k1 k2 k3) (+ n0 k1 (* n2 k2) (* n3 k3))))
    (define (array:3.n.n.-1.-1 n0 n1)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (- k2) (- k3))))
    (define (array:3.n.n.-1.0 n0 n1)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (- k2))))
    (define (array:3.n.n.-1.1 n0 n1)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (- k2) k3)))
    (define (array:3.n.n.-1.n n0 n1 n3)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (- k2) (* n3 k3))))
    (define (array:3.n.n.0.-1 n0 n1)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (- k3))))
    (define (array:3.n.n.0.0 n0 n1) (lambda (k1 k2 k3) (+ n0 (* n1 k1))))
    (define (array:3.n.n.0.1 n0 n1) (lambda (k1 k2 k3) (+ n0 (* n1 k1) k3)))
    (define (array:3.n.n.0.n n0 n1 n3)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (* n3 k3))))
    (define (array:3.n.n.1.-1 n0 n1)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) k2 (- k3))))
    (define (array:3.n.n.1.0 n0 n1) (lambda (k1 k2 k3) (+ n0 (* n1 k1) k2)))
    (define (array:3.n.n.1.1 n0 n1) (lambda (k1 k2 k3) (+ n0 (* n1 k1) k2 k3)))
    (define (array:3.n.n.1.n n0 n1 n3)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) k2 (* n3 k3))))
    (define (array:3.n.n.n.-1 n0 n1 n2)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (* n2 k2) (- k3))))
    (define (array:3.n.n.n.0 n0 n1 n2)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (* n2 k2))))
    (define (array:3.n.n.n.1 n0 n1 n2)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (* n2 k2) k3)))
    (define (array:3.n.n.n.n n0 n1 n2 n3)
      (lambda (k1 k2 k3) (+ n0 (* n1 k1) (* n2 k2) (* n3 k3)))))
  (define (array:n n0 ns)
    (lambda ks
      (do ((ns ns (cdr ns))
           (ks ks (cdr ks))
           (dx n0 (+ dx (* (car ns) (car ks)))))
          ((null? ns) dx)))))
